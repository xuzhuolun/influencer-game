# 实现任务：移动端适配与模块划分优化

**Task ID:** mobile-adapt-module-refactor  
**创建日期:** 2026-02-12  
**状态:** 待实现

## 摘要

| 指标 | 值 |
|------|---|
| 总任务数 | 13 |
| 预计工作量 | 约 18–26 小时 |
| 阶段数 | 4 |

---

## 阶段 1：现状盘点与设计对齐

**目标：** 完成多视口走查与问题记录，明确主游戏信息分区与三 Tab 对应关系，为阶段 2 提供依据。

### 任务 1.1：多视口走查与问题记录

**描述：** 在 320px、375px、414px、768px 视口下依次走查创角三屏（起名→类别→平台）、主游戏三 Tab（个人主页 / 消息 / 行动）、以及主要弹窗（事件、月度总结、游戏结束、说明、创角鼓励）。记录布局错位、文字截断、点击困难、滚动冲突、底栏遮挡等问题。

**验收标准：**
- [ ] 四种视口下均完成至少一轮完整流程（创角→主游戏→触发至少一种弹窗）。
- [ ] 问题清单已写入 `specs/active/mobile-adapt-module-refactor/audit-mobile.md`，每条问题包含：视口、页面/区块、现象、严重程度（高/中/低）。

**工作量：** 2–3 小时  
**优先级：** 高  
**依赖：** 无

---

### 任务 1.2：主游戏信息分区与三 Tab 对应说明

**描述：** 对照 feature-brief 中「数值→消息→行动」的动线，确认主游戏「顶-中-底」信息分区与现有三 Tab（tab-profile / tab-messages / tab-actions）的对应关系。输出简短说明或列表（可写在 audit-mobile.md 末尾或单独小节），便于阶段 2 改样式时保持层级一致。

**验收标准：**
- [ ] 文档中明确：顶部身份/数值、中部动态或消息、底部行动/结算分别对应哪些 DOM 区块与 Tab。
- [ ] 与《互联网大厂模拟器》式「消息/事件集中、回合行动明确」的对照要点已列出（可选）。

**工作量：** 1 小时  
**优先级：** 中  
**依赖：** 无

---

### 任务 1.3：断点与触控热区决策

**描述：** 根据任务 1.1 的问题清单，决定是否增加 480px、320px 断点；确认需要保证 ≥44px 触控热区的关键控件列表（如底部 Tab 项、主要按钮、创角中的单选/头像选择等），并写入 audit-mobile.md 或 plan 的待解决问题小节。

**验收标准：**
- [ ] 是否采用 480px/320px 断点已有结论并记录理由。
- [ ] 需保证触控热区的关键控件列表已列出，供阶段 2 实现时逐项落实。

**工作量：** 0.5–1 小时  
**优先级：** 中  
**依赖：** 任务 1.1

---

## 阶段 2：移动端样式与触控

**目标：** 按问题清单与触控清单，在 css/style.css 中完成移动端媒体查询与样式调整，保证可读、可点、少横向滚动与底栏安全区。

### 任务 2.1：全局与创角区移动端样式

**描述：** 在 `css/style.css` 的 `max-width: 768px`（及已决定的 480px/320px）内，调整 body、#game-container 的 padding/max-width；调整创角三屏的 .content-box、.attribute-list、.gender-list、.avatar-list、输入框与按钮的字号、间距、网格列数，并保证创角中关键按钮与可点击区域触控热区 ≥44px。

**验收标准：**
- [ ] 320px～768px 下创角三屏无横向滚动，关键操作可一次点击完成。
- [ ] 创角区已纳入的触控热区清单项均满足 ≥44px（或通过 padding 等效保证）。

**工作量：** 3–4 小时  
**优先级：** 高  
**依赖：** 任务 1.1、1.3

---

### 任务 2.2：主游戏区与底部导航移动端样式

**描述：** 在移动端媒体查询内调整 .status-bar-compact、.tab-content-area、.tab-panel 的 padding 与字号；调整 .bottom-tab-nav 高度与触控热区（≥44px），并增加 `padding-bottom: env(safe-area-inset-bottom)` 以适配刘海屏/Home 条。确保各 .tab-panel 的 padding-bottom 与底栏高度一致，无内容被遮挡。

**验收标准：**
- [ ] 主游戏三 Tab 在 375px 下内容区可纵向滚动且不被底栏遮挡。
- [ ] 底部 Tab 项触控热区 ≥44px，安全区在支持 env() 的浏览器下生效。

**工作量：** 2–3 小时  
**优先级：** 高  
**依赖：** 任务 1.1

---

### 任务 2.3：弹窗与列表/卡片移动端样式

**描述：** 在移动端断点内调整 .modal-content 的 max-width、padding、字号及内部滚动，确保事件弹窗、月度总结、游戏结束、说明、创角鼓励等无横向溢出。主游戏内列表与卡片（如消息分类卡片、行动列表）在小屏下为单列或合理列数，无挤压或重叠。

**验收标准：**
- [ ] 所有主要弹窗在 375px 下可完整查看与关闭，无横向滚动条。
- [ ] 消息 Tab、行动 Tab 内列表/卡片在 320px～768px 下布局合理、可读可点。

**工作量：** 2 小时  
**优先级：** 高  
**依赖：** 任务 1.1

---

### 任务 2.4：可选断点与细节打磨（480px/320px）

**描述：** 若任务 1.3 决定增加 480px 或 320px 断点，在本任务中实现对应样式（如创角单列、行动列表单列、Tab 仅图标或短文案）；并做一次通盘检查，修正遗漏的间距、字号或触控热区。

**验收标准：**
- [ ] 已决定的额外断点均有对应样式且与 768px 规则不冲突。
- [ ] 在最小支持的视口（如 320px）下无严重错位或无法点击的元素。

**工作量：** 1–2 小时  
**优先级：** 中  
**依赖：** 任务 2.1、2.2、2.3，任务 1.3

---

## 阶段 3：模块边界标注

**目标：** 在 HTML/CSS/JS 中显式标注创角、主游戏三 Tab、全局弹窗的边界，便于后续维护与按模块改版。

### 任务 3.1：index.html 模块注释与 class（可选）

**描述：** 在 index.html 中为创角三屏、主游戏容器、三个 tab-panel、全局弹窗区块增加 HTML 注释或统一 class（如 m-module-naming、m-module-main-tabs、m-module-modal）。不修改现有 id、data-tab 及任何事件绑定所需的属性。

**验收标准：**
- [ ] 创角、主游戏、弹窗三大块在源码中可通过注释或 class 快速定位。
- [ ] 现有功能与 ui.js/game.js 的绑定行为未改变。

**工作量：** 1 小时  
**优先级：** 中  
**依赖：** 无

---

### 任务 3.2：css/style.css 区块注释

**描述：** 在 style.css 中按「创角 / 主游戏-个人主页 / 主游戏-消息 / 主游戏-行动 / 全局弹窗」等区块增加注释或分区标题，便于后续按模块查找、修改或拆分文件。

**验收标准：**
- [ ] 主要样式块（创角、三 Tab 内容、底栏、弹窗）均有清晰注释或分区标记。
- [ ] 媒体查询内的移动端样式也按区块归类或注释，避免与桌面样式混淆。

**工作量：** 1 小时  
**优先级：** 中  
**依赖：** 无

---

### 任务 3.3：js 事件与 screen/tab 对应注释

**描述：** 在 js/ui.js（或相关文件）中确认事件绑定与各 screen、tab 的对应关系；在 switchScreen、switchMainTab 及创角/主游戏/弹窗相关处理函数上方增加简短注释，标明所控制的视图模块。

**验收标准：**
- [ ] 阅读代码时可快速看出「哪些事件属于创角、哪些属于主游戏、哪些属于弹窗」。
- [ ] 未改变任何逻辑或绑定目标。

**工作量：** 0.5–1 小时  
**优先级：** 低  
**依赖：** 无

---

## 阶段 4：验证与收尾

**目标：** 在多视口与桌面端完成功能与样式回归，确认成功标准达成并收尾文档。

### 任务 4.1：移动端核心流程与成功标准验证

**描述：** 在 375px 及 768px 下复测：创角完整流程（起名→定位→头像→属性→选类→选平台）、主游戏三 Tab 切换、主要弹窗（事件、月度、游戏结束、说明）的打开/关闭、以及「结算本月」与游戏结束流程。确认 feature-brief 中的成功标准：无横向滚动、关键按钮易点、主游戏信息层级与「数值→消息→行动」一致。

**验收标准：**
- [ ] 375px 下创角四步、主游戏三 Tab 及主要弹窗均满足成功标准（无横向滚动、关键按钮易点、无严重遮挡）。
- [ ] 主游戏界面信息层级与设计意图一致，模块在代码与注释上边界清晰（阶段 3 已完成）。

**工作量：** 1.5–2 小时  
**优先级：** 高  
**依赖：** 任务 2.1、2.2、2.3，任务 3.1、3.2、3.3

---

### 任务 4.2：桌面端回归与多尺寸抽查

**描述：** 在 ≥768px 视口下回归创角、主游戏、弹窗的布局与交互，确认无退化。在 320px、414px 等尺寸下做抽查，确保无遗漏的错位或溢出。若有真机，在至少一台设备上进行快速验证；否则使用 DevTools 设备模式完成多分辨率确认。

**验收标准：**
- [ ] 桌面端（≥768px）表现与改动前无明显退化。
- [ ] 至少 2 种移动端宽度（如 320、375 或 414）下已抽查且无严重问题。

**工作量：** 1–1.5 小时  
**优先级：** 高  
**依赖：** 任务 4.1

---

### 任务 4.3：问题清单与方案文档收尾

**描述：** 将 audit-mobile.md 中已修复项标记为已解决；若有新增的待解决问题或后续建议，更新到 feature-brief 或 plan 的「待解决问题」小节。可选：在 feature-brief 的「下一步行动」中勾选已完成项或更新状态。

**验收标准：**
- [ ] 问题清单中已修复项有明确标记。
- [ ] 本任务的待解决问题与后续建议已同步到规格/方案文档（如有）。

**工作量：** 0.5 小时  
**优先级：** 低  
**依赖：** 任务 4.1、4.2

---

## 快速参考清单

- [ ] 任务 1.1：多视口走查与问题记录
- [ ] 任务 1.2：主游戏信息分区与三 Tab 对应说明
- [ ] 任务 1.3：断点与触控热区决策
- [ ] 任务 2.1：全局与创角区移动端样式
- [ ] 任务 2.2：主游戏区与底部导航移动端样式
- [ ] 任务 2.3：弹窗与列表/卡片移动端样式
- [ ] 任务 2.4：可选断点与细节打磨（480px/320px）
- [ ] 任务 3.1：index.html 模块注释与 class（可选）
- [ ] 任务 3.2：css/style.css 区块注释
- [ ] 任务 3.3：js 事件与 screen/tab 对应注释
- [ ] 任务 4.1：移动端核心流程与成功标准验证
- [ ] 任务 4.2：桌面端回归与多尺寸抽查
- [ ] 任务 4.3：问题清单与方案文档收尾

---

## 下一步

1. 评审任务分解，按阶段顺序执行（1.1 → 1.2 → 1.3 → 2.1 → …）。
2. 运行 `/implement mobile-adapt-module-refactor` 开始执行，或从任务 1.1 手动开始。

---

*使用 SDD 4.0 创建*
