# /brief 命令

在约 30 分钟内创建一个轻量级功能简报，然后开始编码。

---

## 角色定义

通过分析和策略性提问，创建聚焦的功能简报。

**你的职责：**
- 分析功能描述，提取需求要点
- 信息不完整时主动提问澄清
- 搜索代码库寻找现有模式
- 创建文件前先展示计划

**输出文件：** `./docs/specs/active/[task-id]/feature-brief.md`

---

## 使用方法

```
/brief [task-id] [功能描述]
```

**示例：**
```
/brief user-auth JWT 认证系统，包含登录/登出功能
/brief checkout-flow 简化的单页结算流程，支持游客下单
/brief notification-system 移动端实时推送通知
```

---

## 执行流程

### 阶段 1：分析（只读）

**步骤 1：解析请求**
- 从输入中提取 task-id：`{{input}}`
- 提取功能描述
- 识别关键需求和意图

**步骤 2：检查现有模式**
- 在代码库中搜索类似功能
- 在 `./docs/specs/active/` 中查找相关简报
- 记录可复用的模式和规范

**步骤 3：评估信息完整性**

如果以下任何一项不清晰，请提问澄清：
- 这个功能解决什么问题？
- 主要用户是谁？
- 哪些是必须实现的，哪些是锦上添花的？
- 有技术约束或偏好吗？
- 成功的标准是什么？

**提问格式：**
```
在创建简报之前，我有几个问题：

1. [最重要的问题]
2. [第二个问题（如需要）]

（可以跳过不相关的问题）
```

**步骤 4：评估复杂度**

| 指标 | 使用 Brief | 升级到完整 SDD |
|------|-----------|----------------|
| 开发周期 | < 3 周 | > 3 周 |
| 团队规模 | 1-2 人 | 多团队协作 |
| 风险等级 | 低-中 | 高（支付、安全） |
| 架构模式 | 复用现有模式 | 需要新模式 |
| 外部依赖 | 少/无 | 多个外部依赖 |

如果复杂度较高，建议：
> "这个功能看起来可能需要完整的 SDD 2.0 规划。你希望我先创建一个简报，还是使用 `/research` → `/specify` → `/plan` 进行更详细的规划？"

### 阶段 2：规划（展示计划）

**创建文件前先展示计划：**

```
## 简报创建计划

**Task ID:** [task-id]
**功能名称:** [feature name]

**我将创建：**
- 文件: `./docs/specs/active/[task-id]/feature-brief.md`
- 结构: 问题 → 用户 → 需求 → 方案 → 下一步行动

**调研范围（15 分钟）：**
- [在代码库中搜索的内容]
- [要查找的模式]

**简报将包含：**
- 问题陈述和目标用户
- 核心需求（仅必须实现的）
- 技术方案概要
- 3-5 个具体的下一步行动
- 成功标准

**预计时间：** 共 30 分钟

准备好了吗？（或告诉我需要调整的地方）
```

**等待用户确认后再继续。**

### 阶段 3：执行（用户确认后）

**步骤 1：创建目录**
```
./docs/specs/active/[task-id]/
```

**步骤 2：快速调研（15 分钟）**
- 在代码库中搜索类似模式
- 记录关键发现
- 记录可复用的组件

**步骤 3：生成 feature-brief.md**

使用以下结构：

```markdown
# 功能简报: [功能名称]

**Task ID:** [task-id]
**创建日期:** [date]
**状态:** 待开发

---

## 问题陈述

[这个功能解决什么问题？2-3 句话]

## 目标用户

[谁会使用这个功能？尽量具体]

## 核心需求

### 必须实现
- [ ] [需求 1]
- [ ] [需求 2]
- [ ] [需求 3]

### 锦上添花
- [ ] [可选 1]
- [ ] [可选 2]

## 技术方案

[技术方案概要，3-5 句话]

**遵循的模式：**
- [代码库中的现有模式 1]
- [代码库中的现有模式 2]

**关键决策：**
- [决策 1]: [理由]
- [决策 2]: [理由]

## 下一步行动

1. [ ] [第一个具体步骤]
2. [ ] [第二步]
3. [ ] [第三步]

## 成功标准

- [ ] [如何判断完成 1]
- [ ] [如何判断完成 2]

## 待解决问题

- [尚未解决的问题]

---

*使用 SDD 4.0 创建 - 可以开始编码了！*
```

### 阶段 4：验证

验证文件已创建，并包含：问题陈述、3+ 个需求、可执行的下一步行动。

---

## 输出格式

```
✅ 简报已创建: `./docs/specs/active/[task-id]/feature-brief.md`

**摘要：**
- 问题: [一句话描述]
- 核心需求: [数量] 个必须实现
- 下一步行动: [数量] 项

**下一步：** 开始编码，或运行 `/upgrade [task-id]` 升级到完整 SDD 2.0
```

---

## 常见问题

### 问题：功能描述太模糊
**原因**：用户只提供了简单描述，如"做一个仪表盘"
**解决方案**：追问具体问题：
- "这个仪表盘要解决什么具体问题？"
- "谁会使用它？他们需要做什么决策？"
- "需要展示哪些数据？"

### 问题：功能太复杂，不适合用 Brief
**原因**：多团队协作、高风险、或涉及架构变更
**解决方案**：建议使用完整 SDD 2.0：
- "这个功能看起来比较复杂。建议使用 `/research` → `/specify` → `/plan` 进行完整规划。"

### 问题：找不到现有模式
**原因**：新项目或全新功能
**解决方案**：明确说明：
- "未找到现有模式 - 这将建立新的规范"

---

## 相关命令

- `/evolve [task-id]` - 开发过程中更新简报
- `/upgrade [task-id]` - 升级到完整 SDD 2.0
- `/implement [task-id]` - 开始实现（需要 plan.md）
- `/refine [task-id]` - 通过讨论迭代简报
- `/research [task-id]` - 深度模式调研（完整 SDD 2.0）
