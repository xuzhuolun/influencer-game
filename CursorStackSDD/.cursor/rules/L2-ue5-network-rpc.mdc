---
description: "[L2-UE5] RPC å¼€å‘è§„èŒƒ - ç½‘ç»œè°ƒç”¨çº¦æŸå’Œæœ€ä½³å®è·µ"
globs:
  - "**/*.h"
  - "**/*.cpp"
alwaysApply: true
tags: ue5, network, rpc, constraint, pdca
level: L2
scope: ue5-universal
---

# [L2-UE5] RPC å¼€å‘è§„èŒƒ

> **å±‚çº§**: L2 (å­ç³»ç»Ÿè§„åˆ™)
> **ç±»å‹**: `constraint` | **é€‚ç”¨ç‰ˆæœ¬**: UE5.7
> **é€‚ç”¨èŒƒå›´**: `ue5-universal` - æ‰€æœ‰ UE5 ç½‘ç»œé¡¹ç›®é€šç”¨

## âš ï¸ æ ¸å¿ƒåŸåˆ™

**åœºæ™¯ä¸­çš„ Actor ä¸èƒ½ç›´æ¥è°ƒç”¨ RPCï¼**

### [Constraint] RPC é™åˆ¶
*   **[Constraint]** åœºæ™¯ Actorï¼ˆæ—  NetConnectionï¼‰ç¦æ­¢ç›´æ¥å®šä¹‰ Server RPC
*   **[Constraint]** å¿…é¡»é€šè¿‡ `PlayerController` è½¬å‘
*   **[Constraint]** æ‰€æœ‰ `Server` RPC å¿…é¡»å¸¦ `WithValidation`

---

## 1. åœºæ™¯ä¸­ Actor çš„ RPC è°ƒç”¨æ¨¡å¼

### [Constraint] æ ‡å‡†æ¨¡å¼ï¼ˆé€šè¿‡ PlayerControllerï¼‰

```cpp
// 1. åœ¨ PlayerController ä¸­å®šä¹‰ RPC
UFUNCTION(Server, Reliable, WithValidation, Category = "Game|Travel")
void ServerRequestTravelToMap(const FString& MapName);

// 2. åœ¨åœºæ™¯ Actor ä¸­é€šè¿‡ PlayerController è°ƒç”¨
void AMyTriggerActor::OnTriggerActivated()
{
    if (AMyPlayerController* PC = Cast<AMyPlayerController>(GetOwningPlayerController()))
    {
        PC->ServerRequestTravelToMap(MapName); // âœ… æ­£ç¡®
    }
}

// âŒ é”™è¯¯ï¼šåœºæ™¯ Actor ç›´æ¥å®šä¹‰ RPC
UFUNCTION(Server, Reliable, WithValidation) // âŒ é”™è¯¯ï¼
void ServerExecuteAction(const FString& Action);
```

---

## 2. RPC ç±»å‹å¿«é€Ÿå‚è€ƒ

### Server RPCï¼ˆå®¢æˆ·ç«¯â†’æœåŠ¡å™¨ï¼‰
```cpp
UFUNCTION(Server, Reliable, WithValidation, Category = "Category")
void ServerFunctionName(å‚æ•°åˆ—è¡¨);
```

### Client RPCï¼ˆæœåŠ¡å™¨â†’å®¢æˆ·ç«¯ï¼‰
```cpp
UFUNCTION(Client, Reliable, Category = "Category")
void ClientFunctionName(å‚æ•°åˆ—è¡¨);
```

### NetMulticast RPCï¼ˆæœåŠ¡å™¨â†’æ‰€æœ‰å®¢æˆ·ç«¯ï¼‰
```cpp
UFUNCTION(NetMulticast, Reliable, Category = "Category")
void MulticastFunctionName(å‚æ•°åˆ—è¡¨);
```

---

## 3. RPC å‘½åè§„èŒƒ

### [Constraint] å‘½åçº¦æŸ
*   **[Constraint]** Server RPC: `Server` + åŠ¨ä½œåç§°
*   **[Constraint]** Client RPC: `Client` + åŠ¨ä½œåç§°
*   **[Constraint]** Multicast RPC: `Multicast` + åŠ¨ä½œåç§°

---

## âœ… æ£€æŸ¥æ¸…å•

- [ ] åœºæ™¯ Actor ä¸ç›´æ¥å®šä¹‰ RPC â†’ é€šè¿‡ PlayerController è°ƒç”¨
- [ ] RPC å®šä¹‰åœ¨æœ‰ç½‘ç»œè¿æ¥çš„å¯¹è±¡ä¸Š
- [ ] éªŒè¯å‡½æ•°å……åˆ†éªŒè¯æ‰€æœ‰å‚æ•°
- [ ] RPC å‘½åç¬¦åˆè§„èŒƒ

---

**è®°ä½**ï¼š
- ğŸ¯ **åœºæ™¯ä¸­çš„ Actor ä¸èƒ½ç›´æ¥è°ƒç”¨ RPC** â†’ é€šè¿‡ PlayerController
- ğŸ¯ **æ‰€æœ‰ Server RPC å¿…é¡»å¸¦ WithValidation**
- ğŸ¯ **ç»Ÿä¸€å…¥å£** â†’ æ‰€æœ‰ RPC å®šä¹‰åœ¨ PlayerController ä¸­

---

**å±‚çº§**: L2-UE5 | **æœ€åæ›´æ–°**: 2026å¹´2æœˆ
